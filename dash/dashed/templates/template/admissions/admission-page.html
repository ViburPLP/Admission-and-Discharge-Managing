<!DOCTYPE html><!--  This site was created in Webflow. https://webflow.com  --><!--  Last Published: Mon Oct 28 2024 09:43:30 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="67120015fbc396e5f837a0a8" data-wf-site="67101f23c4dd72e625d98d34">
<head>
  <meta charset="utf-8">
  <title>Admission page</title>
  {% load static %}
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="{% static 'css/normalize.css' %}" rel="stylesheet" type="text/css">
  <link href="{% static 'css/webflow.css' %}" rel="stylesheet" type="text/css">
  <link href="{% static 'css/dash-c5ca12.webflow.css' %}" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="{% static 'text/javascript' %}">WebFont.load({  google: {    families: ["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic"]  }});</script>
  <script type="{% static 'text/javascript' %}">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="{% static 'images/favicon.ico' %}" rel="shortcut icon" type="image/x-icon">
  <link href="{% static 'images/webclip.png' %}" rel="apple-touch-icon">
</head>
<body data-w-id="67113bae6c58ef2c24125606" class="body-2">
  <section style="display:none" class="modal-pop-up">
    <form id="admission-form" method="post" action="{% url 'admit_member' member.pk %}">
    {% csrf_token %}
    <div class="div-block-20">
      <h1 data-w-id="5e0ad675-69c4-d235-72e4-fbbddfc1ca19" class="x">X</h1>
    </div>
    <div class="div-block-13">
      <div class="adm-dets">
        <h2 class="modal-title">{{ member.name }} Admission LOU</h2>
      </div>
      <div class="div-block-14">
        <div id="w-node-_5e0ad675-69c4-d235-72e4-fbbddfc1ca22-f837a0a8" class="div-block-15 logo">
          <div id="w-node-_5e0ad675-69c4-d235-72e4-fbbddfc1ca25-f837a0a8" class="tbl-list txt">{company logo}</div>
        </div>
        <div id="w-node-_5e0ad675-69c4-d235-72e4-fbbddfc1ca27-f837a0a8" class="div-block-15"></div>
        <div id="w-node-_5e0ad675-69c4-d235-72e4-fbbddfc1ca2c-f837a0a8" class="div-block-15">
          <div id="w-node-_5e0ad675-69c4-d235-72e4-fbbddfc1ca39-f837a0a8" class="tbl-list txt">Date: {{ current_date }}</div>
        </div>
        <div id="w-node-_5e0ad675-69c4-d235-72e4-fbbddfc1ca34-f837a0a8" class="tbl-list txt">company Ltd. <br>000, fulani Road <br>P.O. Box 00000 - 00000 <br>Nairobi, Kenya. T : +254 712 345 678<br>M : info@company .com <br>W : www.company .com</div>
        <div id="w-node-_5e0ad675-69c4-d235-72e4-fbbddfc1ca31-f837a0a8" class="div-block-15 table">
          <div id="w-node-_98a82f70-84b3-79bb-d13b-e7946cd6c3a1-f837a0a8" class="tbl-list txt">Dear {provider name},<br>‍</div>
          <div id="w-node-d000525e-d9f9-8b8c-a963-f3231e26402f-f837a0a8" class="tbl-list txt">ADMISSION PPROVAL</div>
          <div id="w-node-dac78aba-dc18-baff-c93a-d9f8e830f843-f837a0a8" class="content-table txt">claim number</div>
          <div id="w-node-d458abca-d320-70a0-449f-22adf92a62ef-f837a0a8" class="content-table txt"> </div>
          <div id="w-node-_45627ae5-86a5-5172-3e8e-92a23658f60b-f837a0a8" class="content-table txt">policy holder name</div>
          <div id="w-node-_5cc09a85-7064-5760-d47c-4ea8ac3bdd85-f837a0a8" class="content-table txt">{{ member.scheme}}</div>
          <div id="w-node-_07f3d801-67de-47af-18eb-cd7dde69f08f-f837a0a8" class="content-table txt">claimant name</div>
          <div id="w-node-_654d0978-ad80-c3fe-2b50-03f944384808-f837a0a8" class="content-table txt">{{ member.name }}</div>
          <div id="w-node-_93772394-06a1-c16d-edab-e3070e1e070c-f837a0a8" class="content-table txt">membership number</div>
          <div id="w-node-_4ca56909-64a1-edb0-e244-71053e8f7fdc-f837a0a8" class="content-table txt">{{ member.membership_number }}</div>
          <div id="w-node-_387842f8-baa0-23cc-5182-cdd33f12d029-f837a0a8" class="content-table txt">admission day</div>
          <div id="admission_date" class="content-table txt">{admission date}</div>
          <div id="w-node-af4811d9-c350-887b-673f-29a851cc9173-f837a0a8" class="content-table txt">approval date</div>
          <div id="w-node-_5f2cabb3-9ac3-ad33-8e4c-fbbf2264a7d6-f837a0a8" class="content-table txt">{{ current_date }}</div>
          <div id="w-node-_89f42771-fe71-3be3-2fe1-7e9a8e34ae4c-f837a0a8" class="content-table txt">approved amount</div>
          <div id="approved_amount" class="content-table txt"> approved amount</div>
        </div>
        <div id="w-node-_5e0ad675-69c4-d235-72e4-fbbddfc1ca36-f837a0a8" class="div-block-15">
          <p class="tbl-list txt-2">We undertake to pay for the medical expenses as per the table above for the period of admission which shall be <strong>NET OF NHIF. <br>‍</strong>This approval of treatment covers only the specified conditions, treatments, and/or approved discharge date. <br>Please note the following:<br><br>‍<strong>1.    </strong>The maximum approved amount payable is net of NHIF (the patient should avail NHIF card or pay cash).<br>‍<strong>2.    </strong>Please ensure you give us full disclosure of the condition, medical history and the treatment offered. Kindly provide any additional or new information relating to this condition.<br>‍<strong>3.    </strong>A copy of this letter together with a discharge summary and duly filled claim/preauthorization form should be attached to the detailed invoice for claims processing.<br>‍<strong>4.    </strong>All Preauthorization forms must be signed by both patient and the doctor and sent to company for the claim and payment to be honored. <br>‍<strong>NOTE: <em>This is an initial undertaking and shall be reviewed from time to time and after the final bill is submitted. <br><br>‍</em></strong>Yours Faithfully,<br>{user-name} <br>‍<strong>Care Management.      </strong></p>
        </div>
        <div id="w-node-_5e0ad675-69c4-d235-72e4-fbbddfc1ca3b-f837a0a8" class="footer">
          <div id="w-node-_9fe58499-37fa-59cf-9d30-c5bcbc26b3dd-f837a0a8" class="tbl-list txt">{footer | footer | footer | footer | footer | footer | footer | footer | footer | footer | footer | footer | }</div>
        </div>
      </div>
      <div class="adm-lou">
        <button href="#" class="button w-button" type="submit" >Complete and download</button>
      </div>
    </div>
  </form>
  </section>
  <section class="section">
    <div class="header">
      <div class="logo-div">
        <div class="logo-div">
          <h1 class="heading">Dash_</h1>
        </div>
      </div>
      <div id="user-div" class="user-div">
        <a id="user-div" href="../user/user-page.html" class="user-div w-inline-block">
          <div id="User-greating" class="user-greetings">
            <h4 id="UG-text" class="user-greating-text">Good morning {{user}}</h4>
          </div>
          <div id="User-Icon" class="user-icon"><img src="{% static 'images/permanent-job-stroke-rounded.svg' %}" loading="lazy" alt="" class="image"></div>
        </a>
      </div>
    </div>
  </section>
  <section class="divider-sect"></section>
  <section class="content-sect-1-0">
    <div id="w-node-fdfe0d76-af7f-df40-bc06-38716c850a09-f837a0a8" class="side-bar">
      <a href="../index.html" class="link-block-2 w-inline-block">
        <aside class="sb-item active">
          <div class="sb-item-icon"><img src="{% static 'images/permanent-job-stroke-rounded.svg' %}" loading="lazy" width="Auto" alt=""></div>
          <div class="sb-item-text">
            <h3 class="sb-item-txt">admission</h3>
          </div>
        </aside>
      </a>
      <a href="../index.html" class="link-block-2 w-inline-block">
        <aside class="sb-item">
          <div class="sb-item-icon"><img src="{% static 'images/permanent-job-stroke-rounded.svg' %}" loading="lazy" width="Auto" alt=""></div>
          <div class="sb-item-text">
            <h3 class="sb-item-txt">Schemes</h3>
          </div>
        </aside>
      </a>
      <a href="../index.html" class="link-block-2 w-inline-block">
        <aside class="sb-item">
          <div class="sb-item-icon"><img src="{% static 'images/permanent-job-stroke-rounded.svg' %}" loading="lazy" width="Auto" alt=""></div>
          <div class="sb-item-text">
            <h3 class="sb-item-txt">Providers</h3>
          </div>
        </aside>
      </a>
      <a href="../index.html" class="link-block-2 w-inline-block">
        <aside class="sb-item">
          <div class="sb-item-icon"><img src="{% static 'images/permanent-job-stroke-rounded.svg' %}" loading="lazy" width="Auto" alt=""></div>
          <div class="sb-item-text">
            <h3 class="sb-item-txt">Reporting</h3>
          </div>
        </aside>
      </a>
      <a href="../index.html" class="link-block-2 w-inline-block">
        <aside class="sb-item">
          <div class="sb-item-icon"><img src="{% static 'images/permanent-job-stroke-rounded.svg' %}" loading="lazy" width="Auto" alt=""></div>
          <div class="sb-item-text">
            <h3 class="sb-item-txt">packages</h3>
          </div>
        </aside>
      </a>
    </div>
    <section class="content-wrapper">
      <div class="content-div-basic">
        <h2 class="page-title">admitting {{ member.name }}</h2>
      </div>
      <div class="adm-summary">
        <div class="ben-details">
          <div id="w-node-e66e6e76-67de-601f-283a-6d3869377a7e-f837a0a8" class="maj-min">
            <h5 id="w-node-dd37b3d9-bde0-8764-8bef-b63a5c065aaa-f837a0a8" class="major-field">Membership Number</h5>
            <div id="w-node-_5d5f8563-eef8-72ed-d4b3-04cc60c6e8a9-f837a0a8" class="minor-field">{{ member.membership_number }}</div>
          </div>
          <div id="w-node-df89f824-91b7-d868-226b-c6a84a10ad7d-f837a0a8" class="maj-min">
            <h5 id="w-node-df89f824-91b7-d868-226b-c6a84a10ad7e-f837a0a8" class="major-field">Insurance</h5>
            <div id="w-node-df89f824-91b7-d868-226b-c6a84a10ad80-f837a0a8" class="minor-field">{{ member.payer}} <br></div>
          </div>
          <div id="w-node-ce470526-1cfe-d66d-15cc-ba574b6585e6-f837a0a8" class="maj-min">
            <h5 id="w-node-ce470526-1cfe-d66d-15cc-ba574b6585e7-f837a0a8" class="major-field">Scheme/program</h5>
            <div id="w-node-ce470526-1cfe-d66d-15cc-ba574b6585e9-f837a0a8" class="minor-field">{{ member.scheme}}</div>
          </div>
          <div id="w-node-cf7f9744-c005-d0da-c33f-a6ca80b5d2bf-f837a0a8" class="maj-min">
            <h5 id="w-node-cf7f9744-c005-d0da-c33f-a6ca80b5d2c0-f837a0a8" class="major-field">Relationship</h5>
            <div id="w-node-cf7f9744-c005-d0da-c33f-a6ca80b5d2c2-f837a0a8" class="minor-field">{{ member.relationship }}</div>
          </div>
          <div id="w-node-_140d27db-3557-7928-eb4f-f2bea32651b3-f837a0a8" class="maj-min">
            <h5 id="w-node-_140d27db-3557-7928-eb4f-f2bea32651b4-f837a0a8" class="major-field">policy validity period</h5>
            <div id="w-node-_140d27db-3557-7928-eb4f-f2bea32651b6-f837a0a8" class="minor-field">{{member.validity}}</div>
          </div>
          <div id="w-node-_30b4ca85-ab7b-c4c2-a93d-6243679dc030-f837a0a8" class="maj-min">
            <h5 id="w-node-_30b4ca85-ab7b-c4c2-a93d-6243679dc031-f837a0a8" class="major-field">policy status</h5>
            <div id="w-node-_30b4ca85-ab7b-c4c2-a93d-6243679dc033-f837a0a8" class="minor-field">{{member.status}}<br></div>
          </div>
        </div>

        <form class="adm-details" id="admission-form" method="post" action="{% url 'admit_member' member.pk %}">
          {% csrf_token %}
          <select id="provider" name="service_provider" class="adm-details-field select" required>
            <option class="adm-details-field select" value="" disabled selected>Select provider</option>
            {% for provider in providers %}
                <option value="{{ provider.id }}">{{ provider.name }}</option>
            {% endfor %}
        </select>  
        <select class="adm-details-field select" id="cover_type_dropdown" name="cover_used" onchange="updateCoverDetails()" required>
          <option value="" disabled selected >Select Cover Benefits</option>
              {% for detail in insurance_details %}
                  <option value="{{ detail.id }}"
                          data-cover-value="{{ detail.cover_value }}"
                          data-cover-balance="{{ detail.cover_balance }}">
                      {{ detail.cover_type }}
                  </option>
              {% endfor %}
          </select>
          <input type="date" id="admission_date" name="admission_date" required class="adm-details-field select">
          <input type="text" id="initial_cover_balance" name="initial_cover_balance" placeholder=" ksh 0.00" class="adm-details-field" readonly>        
          <input type="number" id="requested_amount" placeholder="Ksh. 0.00" name="requested_amount" class="adm-details-field">     
          <input type="number" id="lou_amount" placeholder="Ksh. 0.00" name="lou_amount" class="adm-details-field" required>
          <input type="text" id="w-node-af3f604f-34c8-e394-da8f-20469a1cbb0d-f837a0a8" name="admission_diagnosis" onkeypress="handleKeyPress(event)" class="adm-details-field" placeholder=" Add Diagnosis...">
            <div id="w-node-e76ee873-a4a4-51a9-c961-0b617ee76726-f837a0a8" class="adm-details-field list">
              <div id="diagnosis_list" class="dx"> 
                <ol id="w-node-af3f604f-34c8-e394-da8f-20469a1cbb0d-f837a0a8" role="list" class="dx"></ol>
                <input type="hidden" id="admission_diagnosis_description" name="admission_diagnosis_description" required>            
              </div>
            </div>
            <button class="button w-button" type="submit">Admit Member</button>
          <a id="w-node-ac65f898-6ea6-e77d-afb1-c14610c4cbc7-f837a0a8" data-w-id="ac65f898-6ea6-e77d-afb1-c14610c4cbc7" href="#" class="button w-button">Admit member</a>
          <a id="w-node-e01aebf4-9aed-2c1b-c3b5-1c110ac2482b-f837a0a8" href="#" class="button danger w-button">Delete</a>
        </div>
    </form>

      <div class="adm-state-div">
        <div class="adm-state-div top history">
          <h4 id="w-node-fdfe0d76-af7f-df40-bc06-38716c850a53-f837a0a8" class="adm-hx-head">admission history</h4>
        </div>
        <div class="adm-state-div table-div">
          <div class="table-header">
            <table class=" table">
              <thead>
                  <tr>
                      <th>Date</th>
                      <th>Cover/Subcover</th>
                      <th>Diagnosis</th>
                      <th>Service provider</th>
                      <th>Final LOU</th>
                  </tr>
              </thead>
              <tbody>
                  {% for admission in previous_admissions %}
                  <tr class="clickable-row" data-href="{% url 'admitting_member_detail' member.pk %}">
                    <td>{{ admission.discharge_date }}</td>
                    <td>{{ admission.cover_used }}</td>
                    <td>{{ admission.admission_diagnosis }}</td>
                    <td>{{ admission.provider }}</td>
                    <td>{{ admission.final_approved_amount }}</td>
                  </tr>
                  {% empty %}
                  <tr>
                      <td colspan="5" style="text-align:center; padding: 20px;">No previous admissions found.</td>
                  </tr>
                  {% endfor %}
              </tbody>
          </table>
          </div>        
          </div>
      </div>
    </section>
  </section>
  
  
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=67101f23c4dd72e625d98d34" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="{% static '/js/webflow.js'%}" type="text/javascript"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
  <script>
    function setToday() {
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('admission_date').value = today;
      }

  function handleKeyPress(event) {
      if (event.key === 'Enter') {
          addDiagnosis();
          event.preventDefault();
      }
  }

  function addDiagnosis() {
      const diagnosisInput = document.getElementById('w-node-af3f604f-34c8-e394-da8f-20469a1cbb0d-f837a0a8');
      const diagnosisList = document.getElementById('diagnosis_list');
      const diagnosisDescriptionInput = document.getElementById('admission_diagnosis_description');

      if (diagnosisInput.value.trim() !== '') {
          const diagnosisText = diagnosisInput.value.trim();

          // Add diagnosis to the list
          const diagnosisDiv = document.createElement('div');
          diagnosisDiv.classList.add('diagnosis-item');
          diagnosisDiv.innerHTML = `
           <span class="tbl-list">${diagnosisText}</span>
              <button type="button" class="button danger w-button" onclick="removeDiagnosis(this)"> X </button>
           
          `;
          diagnosisList.appendChild(diagnosisDiv);

          // Update hidden input for diagnosis description
          const currentDescription = diagnosisDescriptionInput.value;
          diagnosisDescriptionInput.value = currentDescription ? currentDescription + ', ' + diagnosisText : diagnosisText;

          // Clear the input
          diagnosisInput.value = '';
              }
          }

  function removeDiagnosis(button) {
      const diagnosisDiv = button.parentNode;
      const diagnosisText = diagnosisDiv.querySelector('span').textContent;
      const diagnosisDescriptionInput = document.getElementById('admission_diagnosis_description');

      // Remove the diagnosis from the list
      diagnosisDiv.remove();

      // // Update hidden input for diagnosis description
      // let currentDescription = diagnosisDescriptionInput.value.split(', ').filter(text => text !== diagnosisText);
      // diagnosisDescriptionInput.value = currentDescription.join(', ');      
          }

  document.getElementById("admission-form").addEventListener("submit", function() {
      setTimeout(function() {
          window.location.href = "{% url 'current_admissions' %}";
      }, 2000); 
  });


  function updateCoverDetails() {
      const dropdown = document.getElementById('cover_type_dropdown');
      const selectedOption = dropdown.options[dropdown.selectedIndex];

      const coverBalance = selectedOption.getAttribute('data-cover-balance');

      document.getElementById('initial_cover_balance').value = 'Ksh. ' + coverBalance;
      }

  $(document).ready(function() {
      $('#service_provider').select2({
      placeholder: 'Select a provider',
      allowClear: true
  });

  document.addEventListener('DOMContentLoaded', function() {
    const admissionDateInput = document.getElementById('admission_date');
    const initial_LOU_input = document.getElementById('lou_amount');
    const coverdropdown = document.getElementById('cover_type_dropdown');
    const approvalDiv = document.getElementById('approved_amount');
    // Corrected the typo here
    const admissionDay = document.getElementById('admission_date'); 

    function updateLOU() {
        const admissionDate = admissionDateInput.value;
        const louAmount = initial_LOU_input.value;
        const selectedCover = coverdropdown.options[coverdropdown.selectedIndex]?.text || "No cover selected";
        
        // Use style: 'decimal' to format the amount and prepend 'KSh.'
        approvalDiv.textContent = `${louAmount ? 'KSh. ' + parseFloat(louAmount).toLocaleString('en-KE', { style: 'decimal', minimumFractionDigits: 2, maximumFractionDigits: 2 }) : 'KSh. 0.00'} from ${selectedCover} benefits.`;

        // Corrected the variable assignment
        admissionDay.value = admissionDate; // Assuming you want to update the input value
    }

    admissionDateInput.addEventListener('change', updateLOU);
    initial_LOU_input.addEventListener('change', updateLOU);
    coverdropdown.addEventListener('change', updateLOU);
  });
});
</script>
</body>
</html>