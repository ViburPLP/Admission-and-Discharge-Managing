<!DOCTYPE html><!--  This site was created in Webflow. https://webflow.com  --><!--  Last Published: Mon Oct 28 2024 09:43:30 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="67120015fbc396e5f837a0a8" data-wf-site="67101f23c4dd72e625d98d34" lang="en">
<head>
  <meta charset="utf-8">
  <title>Admission {{ member.name }}</title>
  {% load static %}
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="{% static 'css/normalize.css' %}" rel="stylesheet" type="text/css">
  <link href="{% static 'css/webflow.css' %}" rel="stylesheet" type="text/css">
  <link href="{% static 'css/dash-c5ca12.webflow.css' %}" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="{% static 'text/javascript' %}">WebFont.load({  google: {    families: ["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic"]  }});</script>
  <script type="{% static 'text/javascript' %}">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="{% static 'images/favicon.ico' %}" rel="shortcut icon" type="image/x-icon">
  <link href="{% static 'images/webclip.png' %}" rel="apple-touch-icon">
</head>
<body data-w-id="67113bae6c58ef2c24125606" class="body-2">
  <section class="section">
    <div class="header">
      <div class="logo-div">
        <div class="logo-div">
          <h1 class="heading">Dash_</h1>
        </div>
      </div>
      <div id="user-div" class="user-div">
        <a id="user-div" href="../user/user-page.html" class="user-div w-inline-block">
          <div id="User-greating" class="user-greetings">
            <h4 id="UG-text" class="user-greating-text">{{ greeting }},&nbsp;  {{ user.first_name }}!</h4>
          </div>
          <div id="User-Icon" class="user-icon"><img src="{% static 'images/permanent-job-stroke-rounded.svg' %}" loading="lazy" alt="" class="image"></div>
        </a>
      </div>
    </div>
  </section>
  <section class="divider-sect"></section>
  <section class="content-sect-1-0">
    <div id="w-node-fdfe0d76-af7f-df40-bc06-38716c850a09-f837a0a8" class="side-bar">
      <a href="../index.html" class="link-block-2 w-inline-block">
        <aside class="sb-item active">
          <div class="sb-item-icon"><img src="{% static 'images/permanent-job-stroke-rounded.svg' %}" loading="lazy" width="Auto" alt=""></div>
          <div class="sb-item-text">
            <h3 class="sb-item-txt">admission</h3>
          </div>
        </aside>
      </a>
      <a href="../index.html" class="link-block-2 w-inline-block">
        <aside class="sb-item">
          <div class="sb-item-icon"><img src="{% static 'images/permanent-job-stroke-rounded.svg' %}" loading="lazy" width="Auto" alt=""></div>
          <div class="sb-item-text">
            <h3 class="sb-item-txt">Schemes</h3>
          </div>
        </aside>
      </a>
      <a href="../index.html" class="link-block-2 w-inline-block">
        <aside class="sb-item">
          <div class="sb-item-icon"><img src="{% static 'images/permanent-job-stroke-rounded.svg' %}" loading="lazy" width="Auto" alt=""></div>
          <div class="sb-item-text">
            <h3 class="sb-item-txt">Providers</h3>
          </div>
        </aside>
      </a>
      <a href="../index.html" class="link-block-2 w-inline-block">
        <aside class="sb-item">
          <div class="sb-item-icon"><img src="{% static 'images/permanent-job-stroke-rounded.svg' %}" loading="lazy" width="Auto" alt=""></div>
          <div class="sb-item-text">
            <h3 class="sb-item-txt">Reporting</h3>
          </div>
        </aside>
      </a>
      <a href="../index.html" class="link-block-2 w-inline-block">
        <aside class="sb-item">
          <div class="sb-item-icon"><img src="{% static 'images/permanent-job-stroke-rounded.svg' %}" loading="lazy" width="Auto" alt=""></div>
          <div class="sb-item-text">
            <h3 class="sb-item-txt">packages</h3>
          </div>
        </aside>
      </a>
    </div>
    <section class="content-wrapper">
      <div class="content-div-basic">
        <h2 class="page-title">admitting {{ member.name }}</h2>
      </div>
      <div class="adm-summary">
        <div class="ben-details">
          <div id="w-node-e66e6e76-67de-601f-283a-6d3869377a7e-f837a0a8" class="maj-min">
            <h5 id="w-node-dd37b3d9-bde0-8764-8bef-b63a5c065aaa-f837a0a8" class="major-field">Membership Number</h5>
            <div id="w-node-_5d5f8563-eef8-72ed-d4b3-04cc60c6e8a9-f837a0a8" class="minor-field">{{ member.membership_number }}</div>
          </div>
          <div id="w-node-df89f824-91b7-d868-226b-c6a84a10ad7d-f837a0a8" class="maj-min">
            <h5 id="w-node-df89f824-91b7-d868-226b-c6a84a10ad7e-f837a0a8" class="major-field">Insurance</h5>
            <div id="w-node-df89f824-91b7-d868-226b-c6a84a10ad80-f837a0a8" class="minor-field">{{ member.payer}} <br></div>
          </div>
          <div id="w-node-ce470526-1cfe-d66d-15cc-ba574b6585e6-f837a0a8" class="maj-min">
            <h5 id="w-node-ce470526-1cfe-d66d-15cc-ba574b6585e7-f837a0a8" class="major-field">Scheme/program</h5>
            <div id="w-node-ce470526-1cfe-d66d-15cc-ba574b6585e9-f837a0a8" class="minor-field">{{ member.scheme}}</div>
          </div>
          <div id="w-node-cf7f9744-c005-d0da-c33f-a6ca80b5d2bf-f837a0a8" class="maj-min">
            <h5 id="w-node-cf7f9744-c005-d0da-c33f-a6ca80b5d2c0-f837a0a8" class="major-field">Relationship</h5>
            <div id="w-node-cf7f9744-c005-d0da-c33f-a6ca80b5d2c2-f837a0a8" class="minor-field">{{ member.relationship }}</div>
          </div>
          <div id="w-node-_140d27db-3557-7928-eb4f-f2bea32651b3-f837a0a8" class="maj-min">
            <h5 id="w-node-_140d27db-3557-7928-eb4f-f2bea32651b4-f837a0a8" class="major-field">policy validity period</h5>
            <div id="w-node-_140d27db-3557-7928-eb4f-f2bea32651b6-f837a0a8" class="minor-field">{{member.validity}}</div>
          </div>
          <div id="w-node-_30b4ca85-ab7b-c4c2-a93d-6243679dc030-f837a0a8" class="maj-min">
            <h5 id="w-node-_30b4ca85-ab7b-c4c2-a93d-6243679dc031-f837a0a8" class="major-field">policy status</h5>
            <div id="w-node-_30b4ca85-ab7b-c4c2-a93d-6243679dc033-f837a0a8" class="minor-field">{{member.status}}<br></div>
          </div>
        </div>

        <form class="adm-details" id="admission-form" method="post" action="{% url 'admit_member' member.pk %}">
          {% csrf_token %}
          <select id="provider" name="service_provider" class="adm-details-field select" required>
            <option class="adm-details-field select" value="" disabled selected>Select provider</option>
            {% for provider in providers %}
                <option value="{{ provider.id }}">{{ provider.name }}</option>
            {% endfor %}
        </select>  
        <select class="adm-details-field select" id="cover_type_dropdown" name="cover_used" onchange="updateCoverDetails()" required>
          <option value="" disabled selected >Select Cover Benefits</option>
              {% for detail in insurance_details %}
                  <option value="{{ detail.id }}"
                          data-cover-value="{{ detail.cover_value }}"
                          data-cover-balance="{{ detail.cover_balance }}">
                      {{ detail.cover_type }}
                  </option>
              {% endfor %}
          </select>
          <input type="date" id="admission_date" name="admission_date" required class="adm-details-field select">
          <input type="text" id="initial_cover_balance" name="initial_cover_balance" placeholder=" ksh 0.00" class="adm-details-field" readonly>        
          <input type="number" id="requested_amount" placeholder="Amount requested" name="requested_amount" class="adm-details-field select">     
          <input type="number" id="lou_amount" placeholder="Initial LOU" name="lou_amount" class="adm-details-field select" required>
          <input type="text" id="w-node-af3f604f-34c8-e394-da8f-20469a1cbb0d-f837a0a8" name="admission_diagnosis" onkeypress="handleKeyPress(event)" class="adm-details-field select" placeholder=" Add Diagnosis...">
            <div id="w-node-e76ee873-a4a4-51a9-c961-0b617ee76726-f837a0a8" class="adm-details-field list">
              <div id="diagnosis_list" class="dx"> 
                <ol id="w-node-af3f604f-34c8-e394-da8f-20469a1cbb0d-f837a0a8" role="list" class="dx"></ol>
                <input type="hidden" id="admission_diagnosis_description" name="admission_diagnosis_description" required>            
              </div>
            </div>
          <button type="submit" id="w-node-ac65f898-6ea6-e77d-afb1-c14610c4cbc7-f837a0a8" data-w-id="ac65f898-6ea6-e77d-afb1-c14610c4cbc7" class="button w-button">Admit member</button>
          <a id="w-node-e01aebf4-9aed-2c1b-c3b5-1c110ac2482b-f837a0a8" href="#" class="button danger w-button">Delete</a>
        </div>
    </form>

      <div class="adm-state-div">
        <div class="adm-state-div top history">
          <h4 id="w-node-fdfe0d76-af7f-df40-bc06-38716c850a53-f837a0a8" class="adm-hx-head">admission history</h4>
        </div>
        <div class="adm-state-div table-div">
          <div class="table-header">
            <table class=" table">
              <thead>
                  <tr>
                      <th>Date</th>
                      <th>Cover/Subcover</th>
                      <th>Diagnosis</th>
                      <th>Service provider</th>
                      <th>Final LOU</th>
                  </tr>
              </thead>
              <tbody>
                  {% for admission in previous_admissions %}
                  <tr class="clickable-row" data-href="{% url 'admitting_member_detail' member.pk %}">
                    <td>{{ admission.discharge_date }}</td>
                    <td>{{ admission.cover_used }}</td>
                    <td>{{ admission.admission_diagnosis }}</td>
                    <td>{{ admission.provider }}</td>
                    <td>{{ admission.final_approved_amount }}</td>
                  </tr>
                  {% empty %}
                  <tr>
                      <td colspan="5" style="text-align:center; padding: 20px;">No previous admissions found.</td>
                  </tr>
                  {% endfor %}
              </tbody>
          </table>
          </div>        
          </div>
      </div>
    </section>
  </section>
  
  
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=67101f23c4dd72e625d98d34" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="{% static '/js/webflow.js'%}" type="text/javascript"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
  <script>
    function setToday() {
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('admission_date').value = today;
      }

  function handleKeyPress(event) {
      if (event.key === 'Enter') {
          addDiagnosis();
          event.preventDefault();
      }
  }

  function addDiagnosis() {
      const diagnosisInput = document.getElementById('w-node-af3f604f-34c8-e394-da8f-20469a1cbb0d-f837a0a8');
      const diagnosisList = document.getElementById('diagnosis_list');
      const diagnosisDescriptionInput = document.getElementById('admission_diagnosis_description');

      if (diagnosisInput.value.trim() !== '') {
          const diagnosisText = diagnosisInput.value.trim();

          // Add diagnosis to the list
          const diagnosisDiv = document.createElement('div');
          diagnosisDiv.classList.add('diagnosis-item');
          diagnosisDiv.innerHTML = `
           <span class="tbl-list">${diagnosisText}</span>
              <button type="button" class="button danger w-button" onclick="removeDiagnosis(this)"> X </button>
           
          `;
          diagnosisList.appendChild(diagnosisDiv);

          // Update hidden input for diagnosis description
          const currentDescription = diagnosisDescriptionInput.value;
          diagnosisDescriptionInput.value = currentDescription ? currentDescription + ', ' + diagnosisText : diagnosisText;

          // Clear the input
          diagnosisInput.value = '';
              }
          }

  function removeDiagnosis(button) {
      const diagnosisDiv = button.parentNode;
      const diagnosisText = diagnosisDiv.querySelector('span').textContent;
      const diagnosisDescriptionInput = document.getElementById('admission_diagnosis_description');

      // Remove the diagnosis from the list
      diagnosisDiv.remove();

      // // Update hidden input for diagnosis description
      // let currentDescription = diagnosisDescriptionInput.value.split(', ').filter(text => text !== diagnosisText);
      // diagnosisDescriptionInput.value = currentDescription.join(', ');      
          }

  document.getElementById("admission-form").addEventListener("submit", function() {
      setTimeout(function() {
          window.location.href = "{% url 'current_admissions' %}";
      }, 1000); 
  });


  function updateCoverDetails() {
      const dropdown = document.getElementById('cover_type_dropdown');
      const selectedOption = dropdown.options[dropdown.selectedIndex];

      const coverBalance = selectedOption.getAttribute('data-cover-balance');

      document.getElementById('initial_cover_balance').value = 'Ksh. ' + coverBalance;
      }

  $(document).ready(function() {
      $('#service_provider').select2({
      placeholder: 'Select a provider',
      allowClear: true
  });
});
</script>
</body>
</html>